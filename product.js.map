{"version":3,"file":"product.js","sources":["../src/js/product.js"],"sourcesContent":["import iziToast from \"izitoast\"\nimport \"izitoast/dist/css/iziToast.min.css\"\n\nconst LS_KEY = \"product\"\n\nconst booksContainer = document.querySelector(\".js-list\")\nconst totalPrice = document.querySelector(\".js-total-price\")\nconst buyBtn = document.querySelector(\".buy-product-btn\")\nconst clearCart = document.querySelector(\".clear-cart-btn\")\n\nconst products = JSON.parse(localStorage.getItem(LS_KEY)) || []\n\nbooksContainer.insertAdjacentHTML(\"beforeend\", createMarkup(products))\nrenderPrice(products)\n\nbooksContainer.addEventListener(\"click\", element => {\n\tconst cardBtn = element.target\n\tconst productCard = cardBtn.closest(\".product-card\")\n\tconst productQuantity = productCard.querySelector(\".quantity-input\")\n\n\tlet currentQuantity = parseInt(productQuantity.value)\n\n\tif (cardBtn.classList.contains(\"increase-btn\")) {\n\t\tcurrentQuantity += 1\n\t}\n\n\tif (cardBtn.classList.contains(\"decrease-btn\")) {\n\t\tif (currentQuantity > 1) {\n\t\t\tcurrentQuantity -= 1\n\t\t} else {\n\t\t\tcurrentQuantity = 1\n\t\t}\n\t}\n\n\tconst productId = productCard.dataset.id\n\n\tif (cardBtn.classList.contains(\"remove-card-btn\")) {\n\t\tconst newProducts = products.filter(product => product._id !== productId)\n\t\tlocalStorage.setItem(LS_KEY, JSON.stringify(newProducts))\n\t\tbooksContainer.innerHTML = createMarkup(newProducts)\n\t\treturn renderPrice(newProducts)\n\t}\n\n\tconst product = products.find(product => product._id === productId)\n\n\tif (product) {\n\t\tproductQuantity.value = currentQuantity\n\t\tproduct.quantity = currentQuantity\n\t\tlocalStorage.setItem(LS_KEY, JSON.stringify(products))\n\t\trenderPrice(products)\n\t}\n})\n\nfunction renderPrice(arr) {\n\tlet allProductsPrice\n\tconst priceBox = document.querySelector(\".total-price-container\")\n\tconst cartTitle = document.querySelector(\".product-cart-title\")\n\n\tif (arr.length) {\n\t\tcartTitle.classList.add(\"hidden\")\n\t\tpriceBox.classList.remove(\"hidden\")\n\t\tallProductsPrice = Math.ceil(\n\t\t\tarr.reduce((acc, { price, quantity }) => (acc += price * quantity), 0)\n\t\t)\n\t\ttotalPrice.textContent = `Total price: ${allProductsPrice}$`\n\t}\n}\n\nbuyBtn.addEventListener(\"click\", () => {\n\tiziToast.success({\n\t\ttitle: \"Book Shop\",\n\t\tmessage: \"Thank you for your purchase!\",\n\t\tposition: \"bottomRight\",\n\t\tcolor: \"#fff\",\n\t})\n\tlocalStorage.removeItem(LS_KEY)\n\tsetTimeout(() => {\n\t\tlocation.href = \"index.html\"\n\t}, 1500)\n})\n\nclearCart.addEventListener(\"click\", () => {\n\tlocalStorage.removeItem(LS_KEY)\n\tlocation.href = \"index.html\"\n\treturn\n})\n\nfunction createMarkup(arr) {\n\treturn arr\n\t\t.map(\n\t\t\t({ _id, book_image, title, author, price, quantity }) => `\n    <li class=\"product-list-item\">\n              <div class=\"product-card\" data-id=\"${_id}\">\n                <button class=\"remove-card-btn\" type=\"button\">\n                  <svg class=\"remove-card-icon\" width=\"24\" height=\"24\">\n                    <use href=\"../img/sprite.svg#icon-close\"></use>\n                  </svg>\n                </button>\n                <img\n                  class=\"product-card-image\"\n                  src=\"${book_image}\"\n                  alt=\"${title}\"\n                  width=\"339\"\n                  height=\"512\"\n                />\n                <div class=\"product-card-info\">\n                  <h3 class=\"product-title\">${title}</h3>\n                  <p class=\"product-author\">${author}</p>\n                  <p class=\"product-price\">${Math.ceil(price * quantity)}$</p>\n                  <div class=\"product-quantity-container\">\n                    <button class=\"decrease-btn quantity-btn\" type=\"button\">\n                      -\n                    </button>\n                    <input class=\"quantity-input\" type=\"number\" min=\"1\" value=\"${quantity}\" disabled />\n                    <button class=\"increase-btn quantity-btn\" type=\"button\">\n                      +\n                    </button>\n                  </div>\n                </div>\n              </div>\n            </li>\n            `\n\t\t)\n\t\t.join(\"\")\n}\n"],"names":["LS_KEY","booksContainer","totalPrice","buyBtn","clearCart","products","createMarkup","renderPrice","element","cardBtn","productCard","productQuantity","currentQuantity","productId","newProducts","product","arr","allProductsPrice","priceBox","cartTitle","acc","price","quantity","iziToast","_id","book_image","title","author"],"mappings":"oFAGA,MAAMA,EAAS,UAETC,EAAiB,SAAS,cAAc,UAAU,EAClDC,EAAa,SAAS,cAAc,iBAAiB,EACrDC,EAAS,SAAS,cAAc,kBAAkB,EAClDC,EAAY,SAAS,cAAc,iBAAiB,EAEpDC,EAAW,KAAK,MAAM,aAAa,QAAQL,CAAM,CAAC,GAAK,CAAE,EAE/DC,EAAe,mBAAmB,YAAaK,EAAaD,CAAQ,CAAC,EACrEE,EAAYF,CAAQ,EAEpBJ,EAAe,iBAAiB,QAASO,GAAW,CACnD,MAAMC,EAAUD,EAAQ,OAClBE,EAAcD,EAAQ,QAAQ,eAAe,EAC7CE,EAAkBD,EAAY,cAAc,iBAAiB,EAEnE,IAAIE,EAAkB,SAASD,EAAgB,KAAK,EAEhDF,EAAQ,UAAU,SAAS,cAAc,IAC5CG,GAAmB,GAGhBH,EAAQ,UAAU,SAAS,cAAc,IACxCG,EAAkB,EACrBA,GAAmB,EAEnBA,EAAkB,GAIpB,MAAMC,EAAYH,EAAY,QAAQ,GAEtC,GAAID,EAAQ,UAAU,SAAS,iBAAiB,EAAG,CAClD,MAAMK,EAAcT,EAAS,OAAOU,GAAWA,EAAQ,MAAQF,CAAS,EACxE,oBAAa,QAAQb,EAAQ,KAAK,UAAUc,CAAW,CAAC,EACxDb,EAAe,UAAYK,EAAaQ,CAAW,EAC5CP,EAAYO,CAAW,CAC9B,CAED,MAAMC,EAAUV,EAAS,KAAKU,GAAWA,EAAQ,MAAQF,CAAS,EAE9DE,IACHJ,EAAgB,MAAQC,EACxBG,EAAQ,SAAWH,EACnB,aAAa,QAAQZ,EAAQ,KAAK,UAAUK,CAAQ,CAAC,EACrDE,EAAYF,CAAQ,EAEtB,CAAC,EAED,SAASE,EAAYS,EAAK,CACzB,IAAIC,EACJ,MAAMC,EAAW,SAAS,cAAc,wBAAwB,EAC1DC,EAAY,SAAS,cAAc,qBAAqB,EAE1DH,EAAI,SACPG,EAAU,UAAU,IAAI,QAAQ,EAChCD,EAAS,UAAU,OAAO,QAAQ,EAClCD,EAAmB,KAAK,KACvBD,EAAI,OAAO,CAACI,EAAK,CAAE,MAAAC,EAAO,SAAAC,CAAU,IAAMF,GAAOC,EAAQC,EAAW,CAAC,CACrE,EACDpB,EAAW,YAAc,gBAAgBe,CAAgB,IAE3D,CAEAd,EAAO,iBAAiB,QAAS,IAAM,CACtCoB,EAAS,QAAQ,CAChB,MAAO,YACP,QAAS,+BACT,SAAU,cACV,MAAO,MACT,CAAE,EACD,aAAa,WAAWvB,CAAM,EAC9B,WAAW,IAAM,CAChB,SAAS,KAAO,YAChB,EAAE,IAAI,CACR,CAAC,EAEDI,EAAU,iBAAiB,QAAS,IAAM,CACzC,aAAa,WAAWJ,CAAM,EAC9B,SAAS,KAAO,YAEjB,CAAC,EAED,SAASM,EAAaU,EAAK,CAC1B,OAAOA,EACL,IACA,CAAC,CAAE,IAAAQ,EAAK,WAAAC,EAAY,MAAAC,EAAO,OAAAC,EAAQ,MAAAN,EAAO,SAAAC,CAAQ,IAAO;AAAA;AAAA,mDAETE,CAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yBAQ7BC,CAAU;AAAA,yBACVC,CAAK;AAAA;AAAA;AAAA;AAAA;AAAA,8CAKgBA,CAAK;AAAA,8CACLC,CAAM;AAAA,6CACP,KAAK,KAAKN,EAAQC,CAAQ,CAAC;AAAA;AAAA;AAAA;AAAA;AAAA,iFAKSA,CAAQ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAStF,EACA,KAAK,EAAE,CACV"}